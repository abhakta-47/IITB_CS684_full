node counthigh(req:bool; cur_freq:int) returns (freq:int)
let 
    freq = cur_freq + if req then 1 else 0;
tel

node mutex<<n:int>>(ack:bool^n) returns (ok:bool)
var freq: int;
let
    freq = fold<<n>>counthigh(ack, 0);
    ok = if freq=1 then true else false;
tel